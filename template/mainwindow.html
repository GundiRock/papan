<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="../bower_components/app-layout/app-toolbar/app-toolbar.html">

<link rel="import" href="drawermenu.html">
<link rel="import" href="profile.html">
<link rel="import" href="game.html">

<dom-module id="papan-main-window">
  <link rel="import" type="css" href="mainwindow.css">

  <template>
    <app-header reveals>
      <app-toolbar>
        <paper-icon-button icon="menu" on-tap="openmenu"></paper-icon-button>
        <div main-title>Papan</div>
        <paper-icon-button icon="bug-report" onclick="toggleDebug()"></paper-icon-button>
        <a href="https://github.com/grumpycoders.papan" style="display: none;" id="github-link">
            <paper-icon-button icon="link"></paper-icon-button>
        </a>
        <div id="username">[[username]]</div>
      </app-toolbar>
    </app-header>
    <papan-drawer-menu menu-selected="{{pageSelected}}" drawer-opened="{{drawerOpened}}"></papan-drawer-menu>

    <iron-pages id="content" selected="{{pageSelected}}" attr-for-selected="name">
      <paper-button name="test" onclick="startGame();">Start Game</paper-button>
      <section name="profile"><papan-user-profile id="profile-view" username="Grumpy Coder"></papan-user-profile></section>
      <section name="game"><papan-game-page></papan-game-page></section>
      <div name="friends" id="games">List of friends</div>
      <div name="games" id="games">List of local games</div>
      <div name="servers" id="servers">List of servers</div>
      <div name="main" id="main-view"></div>
    </iron-pages>
  </template>

  <script>
    Polymer({
      is: "papan-main-window",

      pageSelected: "main",

      properties: {
          username: String,
          picture: String
      },

      listeners: {
        'open-page': 'openPage',
        'show-game': 'showGame',
      },

      openmenu : function() {
          console.info('drawer ' + this.drawerOpened)
        this.drawerOpened = true;//!this.drawerOpened;
      },

      showProfile : function() {
        var pages = document.getElementById('content')
        pages.select('profile')
        this.$.drawer.$.drawermenu.close()
      },

      openPage : function(event) {
        var pages = document.getElementById('content')
        pages.select(event.name)
        this.$.drawer.$.drawermenu.close()
      },

       showGame : function(event) {
        var pages = document.getElementById('content')
        pages.select('game')
        document.getElementById('game-view').setAttribute('name', event.name)
        this.$.drawer.$.drawermenu.close()
      }

    })
  </script>
</dom-module>
